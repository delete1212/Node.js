<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=, initial-scale=1.0">
    <title>Document</title>
    <link href="\main.css" rel="styleSheet">
</head>
    
    <body class="grey-bg">

      <%- include('nav.ejs')%>

        <div class="white-bg">
          <% for (let i = 0; i < posts.length; i++){ %>
          <div class="list-box">
            <h4><a href="/detail/<%= posts[i]._id %>"><%= posts[i].title %></a></h4>
            <p><%= posts[i].content %></p>
            <a href="/edit/<%= posts[i]._id %>">âœï¸</a>
            <span class="delete" data-id="<%= posts[i]._id %>">ğŸ—‘ï¸</span>
          </div>
          <% } %>
        </div> 

        <script src="https://cdn.jsdelivr.net/npm/axios/dist/axios.min.js"></script> 

        <script>

          axios.get('/URL').then((r)=>{console.log(r) })

          const docu = document.querySelectorAll('.delete');
          for (var i = 0; i < docu.length; i++){
          docu[i].addEventListener('click', function(e){
            fetch('/delete?docid=' + e.target.dataset.id, {
              method : 'Delete',
            })
            .thne((r)=>r.text())
            .thne((r)=>{ console.log(r) 
            })
          })
          }

          fetch('/URL')
          .then((r)=>{
            if(r.status == 200) {
              return r.json()
            } else {
              //ì„œë²„ê°€ ì—ëŸ¬ì½”ë“œì „ì†¡ì‹œ ì‹¤í–‰í• ì½”ë“œ
            }
          })
          .then((result)=>{ 
            //ì„±ê³µì‹œ ì‹¤í–‰í• ì½”ë“œ
          }).catch((error)=>{
            //ì¸í„°ë„·ë¬¸ì œ ë“±ìœ¼ë¡œ ì‹¤íŒ¨ì‹œ ì‹¤í–‰í• ì½”ë“œ
            console.log(error)
          })

          document.querySelectorAll('.delete')[0].addEventListener('click', function(e){
            fetch('/delete?docid=' + e.target.dataset.id, {
              method : 'DELETE',
            })
            .then((r)=>r.text())
            .then((r)=>{
              e.target.parentElement.parentElement.style.display = â€˜noneâ€™
            })
          }) 
        </script>
      </body>

</html>